{% extends "base.html.twig" %}

{% block content %}
    <div id="app">
        <transition name="fade">
        <div class="main-options" v-show="main">
            <div id="calendar_button" @click="changeToCalendar">
                Szexnaptár generálása
            </div>

            <div id="random_button" @click="changeToRandom">
                Véletlenszerű szexpóz
            </div>

            <!-- <div>
                Bakancslista
            </div> -->
        </div>
        </transition>

        <transition name="fade">
        <div class="position-container" v-show="random">
            <div class="random-position">
                <img :src="`/gallery/sexpositionsclub_kepek/${ position }.png`">
                <br>
                ${ position }
            </div>
            <button id="get_another_position" @click="changeToRandom">Másikat</button>
        </div>
        </transition>

        <transition name="fade">
        <div class="calendar-container" v-show="calendar">

            {% for time in months %}

                <table>
                    <thead>
                    <tr>
                        <th colspan="7" class="center">
                            {{ time|date('F') }}
                        </th>
                    </tr>
                    <tr>
                        <th width="15%">Monday</th>
                        <th width="15%">Tuesday</th>
                        <th width="16%">Wednesday</th>
                        <th width="15%">Thursday</th>
                        <th width="15%">Friday</th>
                        <th width="12%">Saturday</th>
                        <th width="12%">Sunday</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        {% set daysInMonth = time|date('t') %}
                        {% set startDow = time|date('F 1\\s\\t Y')|date('N') - 1 %}
                        {% set dow = startDow %}
                        {% for day in range(1,daysInMonth) %}
                        {% if loop.first and startDow != 0 %}
                            <td colspan="{{ startDow }}"></td>
                        {% endif %}
                        <td class="day-number">
                            <div>
                                <div>{{ day }} <br> <img src="gallery/sexpositionsclub_kepek/{{ images[random(0,365)] }}"></div>
                                <div>
                                    {# day content here #}
                                </div>
                            </div>
                        </td>
                        {% if loop.last and dow != 6 %}
                            <td colspan="{{ 6 - dow }}">&nbsp;</td>
                        {% endif %}
                        {% if dow == 6 %}
                        {% set dow = 0 %}
                    </tr>
                    <tr>
                        {% else %}
                            {% set dow = dow + 1 %}
                        {% endif %}
                        {% endfor %}
                    </tr>
                    </tbody>
                </table>

            {% endfor %}

        </div>
        </transition>
    </div>

{% endblock %}

{% block script %}
    {{ parent() }}
    <script>
        var app = new Vue({
            delimiters: ['${', '}'],
            el: '#app',
            data: {
                main: true,
                calendar: false,
                random: false,
                position: ''
            },
            methods: {
                changeToRandom() {
                    this.main = false;
                    this.random = true;

                    fetch("/randomPosition", {

                    }).then(response => response.json())
                        .then(json => {
                            if(json.result == "success") {

                                app.position = json.data.position;
                                console.log(app.position)
                            }

                        });
                },
                changeToCalendar() {
                    this.main = false;
                    this.random = false;
                    this.calendar = true;
                }
            }
        });
    </script>
{% endblock %}